from transformers import pipeline

messages = [
    {"role": "user", "content": "\nYou will be given a series of 8 images described in text. After reading the descriptions of the 8 images, you will then be presented with 6 possible image options. Your task is to choose the image that best represents what the next image in the sequence would be based on the descriptions provided.\n\nHere are the descriptions of the 8 images:\n\nImage 1: 3 times 3 sub - blocks with 1 object : a small black square at the top - left,\nImage 2: 3 times 3 sub - blocks with 1 object : a small black square at the top - center.\nImage 3: 3 times 3 sub - blocks with 2 objects : a small black square at the top - right,\nImage 4: 3 times 3 sub - blocks with 1 object : a small black square at the left - center.\nImage 5: 3 times 3 sub - blocks with 1 object : a small black square at the center.\nImage 6: 3 times 3 sub - blocks with 1 object : a small black square at the bottom - left,\nImage 7: 3 times 3 sub - blocks with 1 object : a small black square at the bottom - left,\nImage 8: 3 times 3 sub - blocks with 1 object : a medium black square at the bottom - center.\nBased on the sequence of these images, choose the image that best represents the next one in the series. Here are the 6 options:\n\nOption A: 3 times 3 sub - blocks, 3 objects ; one small black square at the bottom - right,\nOption B: 3 times 3 sub - blocks with 1 object ; one small black square at the bottom - left ;\nOption C: 3 times 3 sub - blocks with 1 object : a small black square at the bottom - left,\nOption D: 3 times 3 sub - blocks with 1 object ; small black square at bottom - left, large white\nOption E: 3 times 3 sub - blocks with 1 object : a small black square at the top - center.\nOption F: 3 times 3 sub - blocks with 1 object ; a small black square at the center.\nPlease respond with the letter corresponding to the image you think follows the sequence.\n    "},
]
pipe = pipeline("text-generation", model="meta-llama/Llama-3.1-8B-Instruct")
print(pipe(messages))